---
title: "Robust Measures of Tail Weight in Distributions"
description: "Traditional measures like kurtosis have long been used to capture the weight of the tails of a distribution. However, kurtosis comes with limitations, particularly its sensitivity to outliers and lack of robustness. In this blog post, we will explore two robust measures for tail weight."
author: "Christian L. Goueguel"
date: "10/20/2023"
image: "cover.png"
editor: visual
categories:
  - Preprocessing
  - Chemometrics
  - Machine Learning
  - Outliers
  - Data Visualization
---

::: justified
![Photo by [Oliver Plattner](https://unsplash.com/photos/photography-of-bridge-WY302kitn7U?utm_content=creditShareLink&utm_medium=referral&utm_source=unsplash).](cover.png){fig-align="center"}

In the world of spectrochemical data analysis, understanding the tail behavior of a distribution is critical for identifying outliers. Traditional measures like kurtosis have long been used to capture the weight of the tails of a distribution. However, kurtosis comes with limitations, particularly its sensitivity to outliers and lack of robustness. In this blog post, we will explore two robust measures for tail weight:

1.  Quantile Tail Weight (QTW) Measure

2.  Medcouple Tail Weight (MTW) Measure

Both measures were proposed in the work of Brys, Hubert, and Struyf (2006), who introduced these methods to provide a more stable and reliable way of analyzing tail weight.

Let's begin with why tail weight matters and examine the limitations of traditional kurtosis. Light-tailed distributions (e.g., Normal distribution) have very few extreme values, whereas heavy-tailed distributions (e.g., Cauchy, Student's t-distribution) contain more extreme values, and outliers occur more frequently. If a measure of tail weight is unreliable or sensitive to extreme observations, the analysis can be skewed, leading to poor decisions.

## **Kurtosis**

Kurtosis measures the degree of peakedness and tail heaviness relative to a Normal distribution. For a normal distribution, kurtosis = 3. Excess kurtosis (kurtosis - 3) is often used to center the normal reference value at 0. However, kurtosis has a significant weakness: it is highly sensitive to outliers. Even a single extreme observation can disproportionately inflate kurtosis, leading to misleading conclusions.

```{r message=FALSE, warning=FALSE, fig.align='center'}
#| code-fold: true
#| code-summary: "Show the code"
library(tidyverse)
library(moments)
set.seed(123)
normal_data <- rnorm(1000)
outlier_data <- c(normal_data, rep(10, 5))
kurtosis_normal <- kurtosis(normal_data)
kurtosis_outlier <- kurtosis(outlier_data)

data_frame(
  Value = c(normal_data, outlier_data),
  Type = rep(c("Normal Data", "With Outliers"), c(1000, 1005))
  ) %>%
  ggplot(aes(x = Value, fill = Type)) +
  geom_histogram(bins = 30, alpha = 0.6, position = "identity") +
  theme_bw() +
  labs(
    title = "Impact of Outliers on Kurtosis",
    subtitle = paste(
      "Kurtosis (Normal):", round(kurtosis_normal, 2), 
      "| Kurtosis (Outliers):", round(kurtosis_outlier, 2)
      ), 
    x = "", 
    y = "Count"
    )
```

Notice how adding a few extreme outliers significantly increases the kurtosis value. This demonstrates the lack of robustness of kurtosis. To overcome the sensitivity of kurtosis, Brys et al. (2006) introduced two robust measures: Quantile Tail Weight (QTW) and Medcouple Tail Weight (MTW). Both rely on robust statistical properties and are less affected by outliers.

### **Quantile Tail Weight (QTW) Measure**

The QTW measure evaluates the weight of the tails using quantiles. It is based on the interquartile range (IQR) and extreme quantiles. The numerator focuses on extreme quantiles (tail behavior). The denominator normalizes using the IQR, making the measure robust to outliers.

### **Medcouple Tail Weight (MTW) Measure**

The MTW measure uses the **Medcouple** statistic, which is a robust measure of skewness. It focuses on tail asymmetry and provides information about the heaviness of each tail. The Medcouple is defined as a scaled median of all pairwise slopes between data points. It is robust to extreme observations and does not require a predefined model. The resulting MTW measure evaluates the extent of tail heaviness in a distribution, particularly useful when the data is skewed.

```{r message=FALSE, warning=FALSE, fig.align='center'}
#| code-fold: true
#| code-summary: "Show the code"
set.seed(123)
heavy_tail_data <- rt(1000, df = 3) 
light_tail_data <- rnorm(1000)       
kurt_heavy <- kurtosis(heavy_tail_data)
kurt_light <- kurtosis(light_tail_data)

qtw <- function(x) {
  (quantile(x, 0.975) - quantile(x, 0.025)) / (quantile(x, 0.75) - quantile(x, 0.25))
}
qtw_heavy <- qtw(heavy_tail_data)
qtw_light <- qtw(light_tail_data)

data_frame(
  Value = c(heavy_tail_data, light_tail_data),
  Type = rep(c("Heavy Tails", "Light Tails"), each = 1000)
  ) %>%
  ggplot(aes(x = Value, fill = Type)) +
  geom_histogram(bins = 30, alpha = 0.6, position = "identity") +
  theme_bw() +
  labs(
    title = "Comparing Heavy-Tailed and Light-Tailed Distributions",
    subtitle = paste(
      "Kurtosis (Heavy):", round(kurt_heavy, 2),
      "| Kurtosis (Light):", round(kurt_light, 2),
      "| QTW (Heavy):", round(qtw_heavy, 2),
      "| QTW (Light):", round(qtw_light, 2)),
    x = "", 
    y = "Count"
    )
```

## **Conclusion**

Kurtosis, while popular, is not always the best measure of tail weight due to its sensitivity to outliers. Robust alternatives like the Quantile Tail Weight and Medcouple Tail Weight measures provide more reliable insights, particularly in the presence of heavy-tailed or skewed data.
:::
